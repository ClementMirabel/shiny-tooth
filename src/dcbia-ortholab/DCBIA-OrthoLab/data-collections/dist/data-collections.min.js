angular.module("data-collections",[]),angular.module("data-collections").factory("dcbia",["$q","$http","$location",function(a,b,c){return{getClinicalDataCollections:function(){return b({method:"GET",url:"/dcbia/clinical/collections"})},getClinicalDataCollection:function(a){return b({method:"GET",url:"/dcbia/clinical/collection/"+a})},createClinicalDataCollection:function(a){return b({method:"POST",url:"/dcbia/clinical/collection",data:a})},updateClinicalDataCollection:function(a){return b({method:"PUT",url:"/dcbia/clinical/collection",data:a})},deleteClinicalDataCollection:function(a){return b({method:"DELETE",url:"/dcbia/clinical/collection/"+a})},getAllClinicalData:function(){return b({method:"GET",url:"/dcbia/clinical/collection/data"})},getClinicalData:function(a){return b({method:"GET",url:"/dcbia/clinical/collection/data/"+a})},getClinicalDataOwners:function(){return b({method:"GET",url:"/dcbia/clinical/data/owner"})},getClinicalDataOwner:function(a){return b({method:"GET",url:"/dcbia/clinical/data/owner?email="+a})},createClinicalData:function(a){return b({method:"POST",url:"/dcbia/clinical/data",data:a})},updateClinicalData:function(a){return b({method:"PUT",url:"/dcbia/clinical/data",data:a})},deleteClinicalData:function(a){return b({method:"DELETE",url:"/dcbia/clinical/data/"+a})},getMorphologicalDataCollections:function(){return b({method:"GET",url:"/dcbia/morphological/collections"})},getMorphologicalDataCollection:function(a){return b({method:"GET",url:"/dcbia/morphological/collection/"+a})},createMorphologicalDataCollection:function(a){return b({method:"POST",url:"/dcbia/morphological/collection",data:a})},updateMorphologicalDataCollection:function(a){return b({method:"PUT",url:"/dcbia/morphological/collection",data:a})},deleteMorphologicalDataCollection:function(a){return b({method:"DELETE",url:"/dcbia/morphological/collection/"+a})},getAllMorphologicalData:function(){return b({method:"GET",url:"/dcbia/morphological/collection/data"})},getMorphologicalData:function(a){return b({method:"GET",url:"/dcbia/morphological/collection/data/"+a})},createMorphologicalData:function(a){return b({method:"POST",url:"/dcbia/morphological/data",data:a})},addAttachement:function(a,c,d){return b({method:"PUT",url:"/dcbia/"+a+"/"+c,data:d})},getAttachement:function(a,c,d){return b({method:"GET",url:"/dcbia/"+a+"/"+c,responseType:d})},updateMorphologicalData:function(a){return b({method:"PUT",url:"/dcbia/morphological/data",data:a})},deleteMorphologicalData:function(a){return b({method:"DELETE",url:"/dcbia/morphological/data/"+a})},getMorphologicalDataByPatientId:function(a){return b({method:"GET",url:"/dcbia/morphological/data/patientId/"+a})}}}]),angular.module("data-collections").controller("clinicalData",["$scope","$http","dcbia","clusterauth",function($scope,$http,dcbia,clusterauth){clusterauth.getUser().then(function(a){$scope.user=a}),$scope.clinicalDataSectionDisplay={},$scope.clinicalDataCollection={showCreate:!1,newCollection:{items:[],type:"clinicalDataCollection",name:""},collections:[],collectionsProperties:{defaultClinicalDataCollection:{class:""}},selectedForm:-1},$scope.defaultClinicalDataCollection={_id:"defaultClinicalDataCollection",name:"All clinical data",type:"clinicalDataCollection",items:0},$scope.clinicalDataCollection.getClinicalDataCollections=function(){return dcbia.getClinicalDataCollections().then(function(a){delete $scope.clinicalDataCollection.selectedCollection,$scope.clinicalDataCollection.collections=a.data,_.each($scope.clinicalDataCollection.collections,function(a){$scope.clinicalDataCollection.collectionsProperties[a._id]={class:""}})}).catch(console.error)},$scope.clinicalDataCollection.create=function(a){dcbia.createClinicalDataCollection(a).then(function(a){$scope.clinicalDataCollection.getClinicalDataCollections()}).catch(console.error)},$scope.clinicalDataCollection.selectCollection=function(a){$scope.clinicalDataCollection.selectedCollection&&($scope.clinicalDataCollection.collectionsProperties[$scope.clinicalDataCollection.selectedCollection._id].class=""),$scope.clinicalDataCollection.selectedCollection=a,$scope.clinicalDataCollection.collectionsProperties[a._id].class="alert alert-info"},$scope.clinicalDataCollection.getDataCollectionKeys=function(a){var b={};return _.each(a,function(a){_.extend(b,a)}),b._id&&delete b._id,b._rev&&delete b._rev,_.keys(b)},$scope.clinicalDataCollection.select=function(a){$scope.clinicalDataCollection.selectCollection(a);var b;return b="defaultClinicalDataCollection"===a._id?dcbia.getAllClinicalData().then(function(a){return $scope.defaultClinicalDataCollection.items=_.map(a.data,function(a){return a.patientId||(a.patientId="null"),{_id:a._id}}),a}):dcbia.getClinicalData(a._id),b.then(function(a){var b=a.data;$scope.clinicalDataCollection.selectedCollectionData=b,$scope.clinicalDataCollection.selectedCollectionDataKeys=$scope.clinicalDataCollection.getDataCollectionKeys(b)}).catch(console.error)},$scope.clinicalDataCollection.delete=function(a){confirm("Are you sure you want to delete the collection?")&&dcbia.deleteClinicalDataCollection(a._id).then(function(a){return $scope.clinicalDataCollection.getClinicalDataCollections()}).catch(console.error)},$scope.clinicalDataCollection.refreshSelectedCollection=function(){$scope.clinicalDataCollection.select($scope.clinicalDataCollection.selectedCollection).then(function(a){return dcbia.getClinicalDataCollection($scope.clinicalDataCollection.selectedCollection._id).then(function(a){$scope.clinicalDataCollection.selectedCollection=a.data,$scope.clinicalDataCollection.collections=_.map($scope.clinicalDataCollection.collections,function(a){return a._id===$scope.clinicalDataCollection.selectedCollection._id?$scope.clinicalDataCollection.selectedCollection:a})})})},$scope.clinicalDataCollection.addClinicalData=function(a){$scope.clinicalDataCollection.selectCollection(a)},$scope.clinicalDataCollection.update=function(a){return dcbia.updateClinicalDataCollection(a).then(function(b){a._rev=b.data.rev})},$scope.clinicalDataCollection.selectForm=function(a){$scope.clinicalDataCollection.selectedForm===-1?$scope.clinicalDataCollection.selectedForm=a:$scope.clinicalDataCollection.selectedForm!==a&&confirm("You will lose the current changes in this form. Do you want to continue?")&&($scope.clinicalDataCollection.selectedForm=a)},$scope.clinicalDataCollection.getClinicalDataCollections(),$scope.clinical={data:{}},$scope.clinical.clearForm=function(a){var b=$scope.clinical.data.formId;a||(a=confirm("Do you want to clear the current changes?")),a&&($scope.clinical.data={},$scope.clinical.data.formId=b,$scope.clinical.data.date=new Date)},$scope.clinical.create=function(){var a=$scope.clinicalDataCollection.selectedCollection;a?$scope.clinical.data&&$scope.clinical.createClinicalData($scope.clinical.data).then(function(b){return a.items.push({_id:b.data.id}),$scope.clinicalDataCollection.update(a)}).catch(console.error):alert("You need to select a collection first!")},$scope.clinical.createClinicalData=function(a){return a.type="clinicalData",dcbia.createClinicalData(a).catch(console.error)},$scope.clinical.deleteAllFiltered=function(a){confirm("Do you want to delete the items beign displayed?")&&Promise.all(_.map(a,function(a){return dcbia.deleteClinicalData(a._id)}))},$scope.clinical.delete=function(a){if(confirm("Do you want to delete the current item?"))return dcbia.deleteClinicalData(a._id).then(function(){$scope.clinicalDataCollection.refreshSelectedCollection()})},$scope.clinical.edit=function(a){$scope.clinical.dataEdit=_.clone(a)},$scope.clinical.update=function(a){dcbia.updateClinicalData(a).then(function(a){$scope.clinical.showSection=-1,$scope.clinicalDataCollection.select($scope.clinicalDataCollection.selectedCollection)})},$scope.csv={},$scope.$watch("csv.file",function(){$scope.csv.file&&$scope.csv.readFile().then(function(){$scope.$apply()})}),$scope.csv.readFile=function(){return $scope.csv.open($scope.csv.file).then(function(a){var b={};_.each(a,function(a){_.extend(b,a)}),void 0===b.patientId&&($scope.csv.selectPatientId=!0),b=_.keys(b),$scope.csv.selectedCollectionData=a,$scope.csv.selectedCollectionDataKeys=b})},$scope.csv.open=function(a){return new Promise(function(b,c){var d=new FileReader;d.onload=function(a){var c=a.target.result;c.indexOf("\r\n")===-1&&c.indexOf("\r")!==-1&&(c=c.replace(new RegExp("\r","g"),"\n")),b($scope.csv.JSON(c))},d.onerror=function(a){c(a)},d.readAsText(a)})},$scope.csv.camelize=function(a){return a.replace(/(?:^\w|[A-Z]|\b\w)/g,function(a,b){return 0!=b||isNaN(parseInt(a))?0==b?a.toLowerCase():a.toUpperCase():""}).replace(/\s+/g,"").replace(/-/g,"")},$scope.csv.JSON=function(csv){for(var lines=csv.split("\n"),result=[],headers=_.map(lines[0].split(","),function(val){try{return eval(val)}catch(a){return _.isString(val)?$scope.csv.camelize(val):val}}),i=1;i<lines.length;i++){for(var obj={},currentline=_.map(lines[i].split(","),function(val){try{return eval(val)}catch(a){return val}}),j=0;j<headers.length;j++)obj[headers[j]]=currentline[j];result.push(obj)}return result},$scope.csv.create=function(){$scope.csv.selectPatientId&&!$scope.csv.selectedPatientId?alert("Please select a patientId from the available column headers!"):Promise.all(_.map($scope.csv.selectedCollectionData,function(a){var b=_.clone(a);return $scope.csv.selectPatientId&&(b.patientId=a[$scope.csv.selectedPatientId],delete b[$scope.csv.selectedPatientId]),$scope.clinical.createClinicalData(b)})).then(function(a){return _.each(_.pluck(a,"data"),function(a){$scope.clinicalDataCollection.selectedCollection.items.push({_id:a.id})}),$scope.clinicalDataCollection.update($scope.clinicalDataCollection.selectedCollection)}).then(function(a){return delete $scope.csv.selectedCollectionData,delete $scope.csv.selectedCollectionDataKeys,$scope.clinicalDataCollection.select($scope.clinicalDataCollection.selectedCollection)}).catch(console.error)},$scope.csv.export=function(a){var b;b=$scope.clinicalDataCollection.selectedCollection&&a._id===$scope.clinicalDataCollection.selectedCollection._id?Promise.resolve(!0):$scope.clinicalDataCollection.select(a),b.then(function(){var a=$scope.clinicalDataCollection.getDataCollectionKeys($scope.clinicalDataCollection.selectedCollectionData),b=a.toString();b+="\n",_.each($scope.clinicalDataCollection.selectedCollectionData,function(c,d){_.each(a,function(d,e){var f=c[d]?c[d]:"";b+=f,e<a.length-1&&(b+=",")}),d<$scope.clinicalDataCollection.selectedCollectionData.length-1&&(b+="\n")});var c=$scope.clinicalDataCollection.selectedCollection.name;return $scope.clinicalDataCollection.selectedCollection.name.indexOf("csv")===-1&&(c+=".csv"),$scope.csv.download(c,b)})},$scope.csv.download=function(a,b){var c=document.createElement("a"),d=new Blob([b],{type:"text/plain"});c.setAttribute("href",window.URL.createObjectURL(d)),c.setAttribute("download",a),c.dataset.downloadurl=["text/plain",c.download,c.href].join(":"),c.click()}}]),angular.module("data-collections").controller("morphologicalData",["$scope","$http","dcbia","clusterauth",function(a,b,c,d){d.getUser().then(function(b){a.user=b}),a.morphologicalDataSectionDisplay={section:0},a._=_,a.morphologicalDataCollection={newCollection:{items:[],type:"morphologicalDataCollection",name:""},collections:[],collectionsProperties:{defaultMorphologicalDataCollection:{class:""}},section:-1},a.morphologicalData={data:{}},a.defaultMorphologicalDataCollection={_id:"defaultMorphologicalDataCollection",name:"All morphological data",type:"morphologicalDataCollection",items:0},a.morphologicalDataCollection.getMorphologicalDataCollections=function(){return c.getMorphologicalDataCollections().then(function(b){delete a.morphologicalDataCollection.selectedCollection,a.morphologicalDataCollection.collections=b.data,_.each(a.morphologicalDataCollection.collections,function(b){a.morphologicalDataCollection.collectionsProperties[b._id]={class:""}})}).catch(console.error)},a.morphologicalDataCollection.create=function(b){c.createMorphologicalDataCollection(b).then(function(b){return a.morphologicalDataCollection.getMorphologicalDataCollections()}).catch(console.error)},a.morphologicalDataCollection.selectCollection=function(b){a.morphologicalDataCollection.selectedCollection&&(a.morphologicalDataCollection.collectionsProperties[a.morphologicalDataCollection.selectedCollection._id].class=""),a.morphologicalDataCollection.selectedCollection=b,a.morphologicalDataCollection.collectionsProperties[b._id].class="alert alert-info"},a.morphologicalDataCollection.getDataCollectionKeys=function(a){var b={};return _.each(a,function(a){_.extend(b,a)}),b._id&&delete b._id,b._rev&&delete b._rev,b._attachments&&delete b._attachments,b.attachments={},_.keys(b)},a.morphologicalDataCollection.select=function(b){a.morphologicalDataCollection.selectCollection(b);var d;return d="defaultMorphologicalDataCollection"===b._id?c.getAllMorphologicalData().then(function(b){return a.defaultMorphologicalDataCollection.items=_.map(b.data,function(a){return a.patientId||(a.patientId="null"),{_id:a._id}}),b}):c.getMorphologicalData(b._id),d.then(function(b){var c=b.data;a.morphologicalDataCollection.selectedCollectionData=_.map(c,function(a){return a._attachments&&_.extend(a,{attachments:_.keys(a._attachments)}),a}),a.morphologicalDataCollection.selectedCollectionDataKeys=a.morphologicalDataCollection.getDataCollectionKeys(c)}).catch(console.error)},a.morphologicalDataCollection.delete=function(b){confirm("Are you sure you want to delete the collection?")&&c.deleteMorphologicalDataCollection(b._id).then(function(b){return a.morphologicalDataCollection.getMorphologicalDataCollections()}).catch(console.error)},a.morphologicalDataCollection.download=function(a){console.log("TODO")},a.morphologicalDataCollection.addMorphologicalData=function(){void 0==a.morphologicalData.data.date&&(a.morphologicalData.data.date=new Date);var b={patientId:a.morphologicalData.data.patientId,date:a.morphologicalData.data.date,owners:[],type:"morphologicalData"};b.owners.push({user:a.user.email}),c.createMorphologicalData(b).then(function(b){return a.morphologicalDataCollection.selectedCollection.items.push({_id:b.data.id}),Promise.all([c.addAttachement(b.data.id,a.morphologicalData.data.file.name,a.morphologicalData.data.file),c.updateMorphologicalDataCollection(a.morphologicalDataCollection.selectedCollection)])}).then(function(a){console.log(a)}).catch(function(a){alert(JSON.stringify(a))})},a.morphologicalData.delete=function(a){console.log(a)},a.morphologicalData.viewAttachment=function(b,d){a.morphologicalData.surface=null,c.getAttachement(b._id,d,"arraybuffer").then(function(b){a.morphologicalData.surface=b.data})},a.morphologicalDataCollection.getMorphologicalDataCollections()}]),angular.module("data-collections").run(["$templateCache",function(a){"use strict";a.put("./src/clinicalData.template.html",'\n<navbar></navbar>\n<div ng-controller="clinicalData"> \n\n\t<div class="row">\n\t\t<div class="panel panel-default">\n\t  \t\t<div class="panel-body">\n\t\t\t\t<div class="col-md-12">\n\t\t\t\t\t<div class="btn-group">\n\t\t\t\t\t <button type="button" class="btn btn-default" ng-click="clinicalDataCollection.showCreate = true">\n\t\t\t\t\t \t<span class="glyphicon glyphicon-plus"></span>\n\t\t\t\t\t \tNew Collection\n\t\t\t\t\t </button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\n\t<div class="row" ng-if="clinicalDataCollection.showCreate">\n\t\t<div class="panel panel-success">\n\t\t  <div class="panel-body">\n\t\t  \t<div class="input-group">\n\t  \t\t\t<span class="input-group-addon">Name</span>\n\t  \t\t\t<input type="text" class="form-control" placeholder="Collection name" aria-describedby="basic-addon3" ng-model="clinicalDataCollection.newCollection.name">\n\t  \t\t</div>\n\t  \t\t<div class="btn-group">\n\t\t\t\t <button type="button" class="btn btn-default" ng-click="clinicalDataCollection.create(clinicalDataCollection.newCollection);clinicalDataCollection.showCreate=false">\n\t\t\t\t \t<span class="glyphicon glyphicon-ok"></span>\n\t\t\t\t \tCreate\n\t\t\t\t </button>\n\t\t\t\t <button type="button" class="btn btn-default" ng-click="clinicalDataCollection.showCreate = false">\n\t\t\t\t \t<span class="glyphicon glyphicon-remove"></span>\n\t\t\t\t \tCancel\n\t\t\t\t </button>\n\t\t\t\t</div>\n\t\t  </div>\n\t\t</div>\n\t</div>\n\n\t<div class="row" ng-if="!clinicalDataCollection.showCreate">\n\t\t<div class="panel panel-default">\n\t  \t\t<div class="panel-body">\n\t  \t\t\t<div class="col-sm-6 col-md-4">\n\t\t\t\t\t<div ng-class="clinicalDataCollection.collectionsProperties[\'defaultClinicalDataCollection\'].class">\n\t\t\t\t\t    <div class="thumbnail">\n\t\t\t\t\t    \t<!-- <img src="" alt=""> -->\n\t\t\t\t\t      <div class="caption">\n\t\t\t\t\t        <h3>{{defaultClinicalDataCollection.name}}</h3>\n\t\t\t\t\t        <p>\n\t\t\t\t\t        \t<b>Number of items: </b> {{defaultClinicalDataCollection.items.length}}\n\t\t\t\t\t        </p>\n\t\t\t\t        \t<div class="btn-group">\n\t\t\t\t\t\t\t <button type="button" class="btn btn-default" ng-click="clinicalDataCollection.showSection = 0;clinicalDataCollection.select(defaultClinicalDataCollection)">\n\t\t\t\t\t\t\t \t<span class="glyphicon glyphicon-refresh"></span>\n\t\t\t\t\t\t\t </button>\n\n\t\t\t\t\t\t\t <button type="button" class="btn btn-default" ng-click="csv.export(defaultClinicalDataCollection)">\n\t\t\t\t\t\t\t \t<span class="glyphicon glyphicon-download"></span>\n\t\t\t\t\t\t\t </button>\n\t\t\t\t\t\t\t \n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t      </div>\n\t\t\t\t\t    </div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="col-sm-6 col-md-4" ng-repeat="collection in clinicalDataCollection.collections">\n\t\t\t\t\t<div ng-class="clinicalDataCollection.collectionsProperties[collection._id].class">\n\t\t\t\t\t    <div class="thumbnail">\n\t\t\t\t\t    \t<!-- <img src="" alt=""> -->\n\t\t\t\t\t      <div class="caption">\n\t\t\t\t\t        <h3>{{collection.name}}</h3>\n\t\t\t\t\t        <p>\n\t\t\t\t\t        \t<b>Number of items: </b> {{collection.items.length}}\n\t\t\t\t\t        </p>\n\t\t\t\t        \t<div class="btn-group">\n\t\t\t\t\t\t\t <button type="button" class="btn btn-default" ng-click="clinicalDataCollection.showSection = 0;clinicalDataCollection.select(collection)">\n\t\t\t\t\t\t\t \t<span class="glyphicon glyphicon-eye-open"></span>\n\t\t\t\t\t\t\t </button>\n\t\t\t\t\t\t\t <button type="button" class="btn btn-default" ng-click="clinicalDataCollection.showSection = 1;clinicalDataCollection.addClinicalData(collection)">\n\t\t\t\t\t\t\t \t<span class="glyphicon glyphicon-plus-sign"></span>\n\t\t\t\t\t\t\t </button>\n\n\t\t\t\t\t\t\t <button type="button" class="btn btn-default" ng-click="csv.export(collection)">\n\t\t\t\t\t\t\t \t<span class="glyphicon glyphicon-download"></span>\n\t\t\t\t\t\t\t </button>\n\n\t\t\t\t\t\t\t <button type="button" class="btn btn-default" ng-click="clinicalDataCollection.showSection = 2;clinicalDataCollection.select(collection)">\n\t\t\t\t\t\t\t \t<span class="glyphicon glyphicon-signal"></span>\n\t\t\t\t\t\t\t </button>\n\t\t\t\t\t\t\t \n\t\t\t\t\t\t\t <button type="button" class="btn btn-danger" ng-click="clinicalDataCollection.showSection = -1;clinicalDataCollection.delete(collection)">\n\t\t\t\t\t\t\t \t<span class="glyphicon glyphicon-remove-sign"></span>\n\t\t\t\t\t\t\t </button>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t      </div>\n\t\t\t\t\t    </div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div class="panel panel-info" ng-if="clinicalDataCollection.showSection == 0">\n\t\t\t<div class="panel panel-default" ng-if="user.scope.indexOf(\'admin\') !== -1">\n\t\t  \t\t<div class="panel-body">\n\t\t  \t\t\t<div class="btn-group">\n\t\t\t\t\t\t <button type="button" class="btn btn-danger" ng-click="clinical.deleteAllFiltered(clinicalDataCollection.displayedCollection)">\n\t\t\t\t\t\t \tRemoves all filtered<span class="glyphicon glyphicon-remove"></span>\n\t\t\t\t\t\t </button>\n\t\t\t\t\t</div>\n\t\t  \t\t</div>\n\t\t  \t</div>\n\t\t\t<div class="panel panel-default" style="overflow:scroll">\n\t\t  \t\t<div class="panel-body">\n\t\t  \t\t\t<table st-table="clinicalDataCollection.displayedCollection" st-safe-src="clinicalDataCollection.selectedCollectionData" class="table table-striped">\n\t\t\t\t\t\t<thead>\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<th ng-repeat="key in clinicalDataCollection.selectedCollectionDataKeys" st-sort="{{key}}">{{key}}</th>\n\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<th ng-repeat="key in clinicalDataCollection.selectedCollectionDataKeys">\n\t\t\t\t\t\t\t\t\t<input st-search="{{key}}" placeholder="search for {{key}}" class="input-sm form-control" type="search"/>\n\t\t\t\t\t\t\t\t</th>\n\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t</thead>\n\t\t\t\t\t\t<tbody>\n\t\t\t\t\t\t\t<tr ng-repeat="row in clinicalDataCollection.displayedCollection">\n\t\t\t\t\t\t\t\t<td ng-repeat="key in clinicalDataCollection.selectedCollectionDataKeys">{{row[key]}}</td>\n\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t<button type="button" class="btn btn-info" ng-click="clinical.showSection = 0;clinical.edit(row)">\n\t\t\t\t\t\t\t\t\t\t<span class="glyphicon glyphicon-pencil"></span>\n\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t<button type="button" class="btn btn-danger" ng-click="clinical.delete(row)">\n\t\t\t\t\t\t\t\t\t \t<span class="glyphicon glyphicon-remove"></span>\n\t\t\t\t\t\t\t\t\t </button>\n\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t</tbody>\n\t\t\t\t\t</table>\n\t\t  \t\t</div>\n\t\t  \t</div>\n\t\t\t<div class="panel panel-default" ng-if="clinical.showSection == 0">\n\t\t  \t\t<div class="panel-body">\n\t\t  \t\t\t<div class="panel panel-default">\n\t\t  \t\t\t\t<div class="panel-body">\n\t\t  \t\t\t\t\t<div class="btn-group">\n\t\t\t\t\t\t\t\t <button type="button" class="btn btn-default" ng-click="clinical.update(clinical.dataEdit)">\n\t\t\t\t\t\t\t\t \t<span class="glyphicon glyphicon-upload"></span>\n\t\t\t\t\t\t\t\t </button>\n\t\t\t\t\t\t\t\t <button type="button" class="btn btn-default" ng-click="clinical.showSection = -1">\n\t\t\t\t\t\t\t\t \t<span class="glyphicon glyphicon-remove"></span>\n\t\t\t\t\t\t\t\t </button>\n\t\t\t\t\t\t\t</div>\n\t\t  \t\t\t\t</div>\n\t\t  \t\t\t</div>\n\t\t  \t\t\t<div class="panel panel-default">\n\t\t  \t\t\t\t<div class="panel-body">\n\t\t  \t\t\t\t\t<tmj-survey form-data="clinical.dataEdit" ng-if="clinical.dataEdit.formId == \'TMJSurvey\'"></tmj-survey>\n\t\t  \t\t\t\t</div>\n\t\t  \t\t\t</div>\n\n\t\t  \t\t\t<div class="panel panel-default">\n\t\t  \t\t\t\t<div class="panel-body">\n\t\t  \t\t\t\t\t<div class="btn-group">\n\t\t\t\t\t\t\t\t <button type="button" class="btn btn-default" ng-click="clinical.update(clinical.dataEdit)">\n\t\t\t\t\t\t\t\t \t<span class="glyphicon glyphicon-upload">Update</span>\n\t\t\t\t\t\t\t\t </button>\n\t\t\t\t\t\t\t\t <button type="button" class="btn btn-default" ng-click="clinical.showSection = -1">\n\t\t\t\t\t\t\t\t \t<span class="glyphicon glyphicon-remove">Cancel</span>\n\t\t\t\t\t\t\t\t </button>\n\t\t\t\t\t\t\t</div>\n\t\t  \t\t\t\t</div>\n\t\t  \t\t\t</div>\n\t\t  \t\t\t\n\t\t  \t\t</div>\n\t\t  \t</div>\n\t\t\t\n\t\t</div>\n\n\t\t<div class="panel panel-default" ng-if="clinicalDataCollection.showSection == 1">\n\t\t  <div class="panel-body">\n\t\t  \t\n\t\t  \t<div class="panel panel-default">\n\t\t\t  <div class="panel-body">\n\t\t  \t\t<div class="btn-group">\n\n\t\t\t\t\t <button type="button" class="btn btn-default" ng-click="clinicalDataCollection.selectForm(2)">\n\t\t\t\t\t \t<span class="glyphicon glyphicon-list-alt"></span>\n\t\t\t\t\t \tTMJ Survey\n\t\t\t\t\t </button>\n\n\t\t\t\t\t <label class="btn btn-default" for="clinicalData-file-selector" ng-click="clinicalDataCollection.selectedForm = 100">\n\t\t\t\t\t \t<span class="glyphicon glyphicon-folder-open"></span>\n\t\t\t\t\t    <input id="clinicalData-file-selector" file-model=\'csv.file\' type="file" style="display:none;">\n\t\t\t\t\t</label>\n\n\t\t\t\t\t <button type="button" class="btn btn-default" ng-click="clinicalDataCollection.showAddClinicalData = false;clinicalDataCollection.selectedForm = -1">\n\t\t\t\t\t \t<span class="glyphicon glyphicon-remove"></span>\n\t\t\t\t\t \tCancel\n\t\t\t\t\t </button>\n\t\t\t  \t</div>\n\t\t\t  </div>\n\t\t\t</div>\n\n\t\t  \t<div class="panel panel-info" ng-if="clinicalDataCollection.selectedForm !== -1">\n\t\t\t  <div class="panel-body">\n\t\t\t  \t<div class="btn-group">\n\t\t\t  \t\t<button type="button" class="btn btn-default" ng-click="clinical.clearForm(false)">\n\t\t\t\t\t\t<span class="glyphicon glyphicon-minus"></span>\n\t\t\t\t\t\tClear\n\t\t\t\t\t</button>\n\t\t\t\t\t<button type="button" class="btn btn-default" ng-click="clinical.create();clinical.clearForm(true);clinicalDataCollection.selectedForm = -1">\n\t\t\t\t\t\t<span class="glyphicon glyphicon-save"></span>\n\t\t\t\t\t\tSubmit\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t\t<tmj-survey form-data="clinical.data" ng-if="clinicalDataCollection.selectedForm == 2"></tmj-survey>\n\t\t\t\t<div class="btn-group">\n\t\t\t\t\t<button type="button" class="btn btn-default" ng-click="clinical.create();clinical.clearForm(true);clinicalDataCollection.selectedForm = -1">\n\t\t\t\t\t\t<span class="glyphicon glyphicon-save"></span>\n\t\t\t\t\t\tSubmit\n\t\t\t\t\t</button>\n\t\t\t\t</div>\n\t\t\t  </div>\n\t\t\t</div>\n\n\t\t\t<div class="panel panel-info" style="overflow:scroll" ng-if="clinicalDataCollection.selectedForm == 100 && csv.selectedCollectionData">\n\t\t  \t\t<div class="panel-body">\n\n\t\t  \t\t\t<div class="btn-group col-md-3">\n\t\t\t\t\t\t<button type="button" class="btn btn-default" ng-click="csv.create()">\n\t\t\t\t\t\t \t<span class="glyphicon glyphicon-save"></span>\n\t\t\t\t\t\t \tSave\n\t\t\t\t\t\t</button>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class="input-group col-md-6" ng-if="csv.selectPatientId">\n\t\t\t\t\t\t<span class="input-group-addon" id="sizing-addon2">patientId:</span>\n\t\t\t\t\t\t<select ng-model="csv.selectedPatientId" class="form-control">\n\t\t\t\t\t\t\t<option ng-repeat="key in csv.selectedCollectionDataKeys">{{key}}</option>\n\t\t\t\t\t\t</select>\n\t\t\t\t\t</div>\n\n\t\t\t\t  \t<table st-table="csv.displayedCollection" st-safe-src="csv.selectedCollectionData" class="table table-striped" >\n\t\t\t\t\t\t<thead>\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<th ng-repeat="key in csv.selectedCollectionDataKeys" st-sort="{{key}}">{{key}}</th>\n\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t<th ng-repeat="key in csv.selectedCollectionDataKeys">\n\t\t\t\t\t\t\t\t\t<input st-search="{{key}}" placeholder="search for {{key}}" class="input-sm form-control" type="search"/>\n\t\t\t\t\t\t\t\t</th>\n\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t</thead>\n\t\t\t\t\t\t<tbody>\n\t\t\t\t\t\t\t<tr ng-repeat="row in csv.displayedCollection">\n\t\t\t\t\t\t\t\t<td ng-repeat="key in csv.selectedCollectionDataKeys">{{row[key]}}</td>\n\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t</tbody>\n\t\t\t\t\t</table>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t  </div>\n\t\t</div>\n\t\t<div class="panel panel-default" ng-if="clinicalDataCollection.showSection == 2">\n\t\t  <div class="panel-body">\n\t\t  \t<d3-plots data="clinicalDataCollection.selectedCollectionData"></d3-plots>\n\t\t  </div>\n\t\t</div>\n\t\t\n\t</div>\n</div>\n'),a.put("./src/morphologicalData.template.html",'<navbar></navbar>\n\n<div ng-controller="morphologicalData"> \n\n\t<div class="row">\n\t\t<div class="panel panel-default">\n\t  \t\t<div class="panel-body">\n\t\t\t\t<div class="col-md-12">\n\t\t\t\t\t<div class="btn-group">\n\t\t\t\t\t <button type="button" class="btn btn-default" ng-click="morphologicalDataSectionDisplay.section = 1">\n\t\t\t\t\t \t<span class="glyphicon glyphicon-plus"></span>\n\t\t\t\t\t \tNew Collection\n\t\t\t\t\t </button>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\n\t<div class="row" ng-if="morphologicalDataSectionDisplay.section == 1">\n\t\t<div class="panel panel-success">\n\t\t  <div class="panel-body">\n\t\t  \t<div class="input-group">\n\t  \t\t\t<span class="input-group-addon">Name</span>\n\t  \t\t\t<input type="text" class="form-control" placeholder="Collection name" aria-describedby="basic-addon3" ng-model="morphologicalDataCollection.newCollection.name">\n\t  \t\t</div>\n\t  \t\t<div class="btn-group">\n\t\t\t\t <button type="button" class="btn btn-default" ng-click="morphologicalDataCollection.create(morphologicalDataCollection.newCollection);morphologicalDataSectionDisplay.section = 0">\n\t\t\t\t \t<span class="glyphicon glyphicon-ok"></span>\n\t\t\t\t \tCreate\n\t\t\t\t </button>\n\t\t\t\t <button type="button" class="btn btn-default" ng-click="morphologicalDataSectionDisplay.section = 0">\n\t\t\t\t \t<span class="glyphicon glyphicon-remove"></span>\n\t\t\t\t \tCancel\n\t\t\t\t </button>\n\t\t\t\t</div>\n\t\t  </div>\n\t\t</div>\n\t</div>\n\n\t<div class="row" ng-if="morphologicalDataSectionDisplay.section == 0">\n\t\t<div class="panel panel-default">\n\t  \t\t<div class="panel-body">\n\t  \t\t\t<div class="col-sm-6 col-md-4">\n\t\t\t\t\t<div ng-class="morphologicalDataCollection.collectionsProperties[\'defaultMorphologicalDataCollection\'].class">\n\t\t\t\t\t    <div class="thumbnail">\n\t\t\t\t\t    \t<!-- <img src="" alt=""> -->\n\t\t\t\t\t      <div class="caption">\n\t\t\t\t\t        <h3>{{defaultMorphologicalDataCollection.name}}</h3>\n\t\t\t\t\t        <p>\n\t\t\t\t\t        \t<b>Number of items: </b> {{defaultMorphologicalDataCollection.items.length}}\n\t\t\t\t\t        </p>\n\t\t\t\t        \t<div class="btn-group">\n\t\t\t\t\t\t\t <button type="button" class="btn btn-default" ng-click="morphologicalDataCollection.showSection = 0;morphologicalDataCollection.select(defaultMorphologicalDataCollection)">\n\t\t\t\t\t\t\t \t<span class="glyphicon glyphicon-refresh"></span>\n\t\t\t\t\t\t\t </button>\n\n\t\t\t\t\t\t\t <button type="button" class="btn btn-default" ng-click="csv.export(defaultClinicalDataCollection)">\n\t\t\t\t\t\t\t \t<span class="glyphicon glyphicon-download"></span>\n\t\t\t\t\t\t\t </button>\n\t\t\t\t\t\t\t \n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t      </div>\n\t\t\t\t\t    </div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="col-sm-6 col-md-4" ng-repeat="collection in morphologicalDataCollection.collections">\n\t\t\t\t\t<div ng-class="morphologicalDataCollection.collectionsProperties[collection._id].class">\n\t\t\t\t\t    <div class="thumbnail">\n\t\t\t\t\t    \t<!-- <img src="" alt=""> -->\n\t\t\t\t\t      <div class="caption">\n\t\t\t\t\t        <h3>{{collection.name}}</h3>\n\t\t\t\t\t        <p>\n\t\t\t\t\t        \t<b>Number of items: </b> {{collection.items.length}}\n\t\t\t\t\t        </p>\n\t\t\t\t        \t<div class="btn-group">\n\t\t\t\t\t\t\t <button type="button" class="btn btn-default" ng-click="morphologicalDataCollection.section = 0;morphologicalDataCollection.select(collection)">\n\t\t\t\t\t\t\t \t<span class="glyphicon glyphicon-eye-open"></span>\n\t\t\t\t\t\t\t </button>\n\t\t\t\t\t\t\t <button type="button" class="btn btn-default" ng-click="morphologicalDataCollection.section = 1;morphologicalDataCollection.select(collection)">\n\t\t\t\t\t\t\t \t<span class="glyphicon glyphicon-plus-sign"></span>\n\t\t\t\t\t\t\t </button>\n\n\t\t\t\t\t\t\t <button type="button" class="btn btn-default" ng-click="morphologicalDataCollection.download(collection)">\n\t\t\t\t\t\t\t \t<span class="glyphicon glyphicon-download"></span>\n\t\t\t\t\t\t\t </button>\n\n\t\t\t\t\t\t\t <button type="button" class="btn btn-danger" ng-click="morphologicalDataCollection.delete(collection)">\n\t\t\t\t\t\t\t \t<span class="glyphicon glyphicon-remove"></span>\n\t\t\t\t\t\t\t </button>\n\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t      </div>\n\t\t\t\t\t    </div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="panel panel-default" ng-if="morphologicalDataCollection.section != -1">\n\t  \t\t<div class="panel-body">\n\t\t\t\t<div class="row" ng-if="morphologicalDataCollection.section == 0">\n\t\t\t\t\t<div class="panel panel-default">\n\t\t\t  \t\t\t<div class="panel-body">\n\t\t\t  \t\t\t\t<table st-table="morphologicalDataCollection.displayedCollection" st-safe-src="morphologicalDataCollection.selectedCollectionData" class="table table-striped">\n\t\t\t\t\t\t\t\t<thead>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<th ng-repeat="key in morphologicalDataCollection.selectedCollectionDataKeys" st-sort="{{key}}">{{key}}</th>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t\t<tr>\n\t\t\t\t\t\t\t\t\t\t<th ng-repeat="key in morphologicalDataCollection.selectedCollectionDataKeys">\n\t\t\t\t\t\t\t\t\t\t\t<input st-search="{{key}}" placeholder="search for {{key}}" class="input-sm form-control" type="search"/>\n\t\t\t\t\t\t\t\t\t\t</th>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t</thead>\n\t\t\t\t\t\t\t\t<tbody>\n\t\t\t\t\t\t\t\t\t<tr ng-repeat="row in morphologicalDataCollection.displayedCollection">\n\t\t\t\t\t\t\t\t\t\t<td ng-repeat="key in morphologicalDataCollection.selectedCollectionDataKeys">\n\t\t\t\t\t\t\t\t\t\t\t<div ng-if="_.isArray(row[key]) && key != \'owners\'">\n\t\t\t\t\t\t\t\t\t\t\t\t<button type="button" class="btn btn-default" ng-repeat="att in row[key]" ng-click="morphologicalData.viewAttachment(row, att)">\n\t\t\t\t\t\t\t\t\t\t\t\t\t<span class="glyphicon glyphicon-eye"></span>{{att}}\n\t\t\t\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t<div ng-if="!_.isArray(row[key])">\n\t\t\t\t\t\t\t\t\t\t\t\t{{row[key]}}\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t\t<div ng-if="_.isArray(row[key]) && key == \'owners\'">\n\t\t\t\t\t\t\t\t\t\t\t\t<ul>\n\t\t\t\t\t\t\t\t\t\t\t\t\t<li ng-repeat="item in row[key]">{{item.user}}</li>\n\t\t\t\t\t\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t\t<td>\n\t\t\t\t\t\t\t\t\t\t\t<button type="button" class="btn btn-danger" ng-click="clinical.delete(row)">\n\t\t\t\t\t\t\t\t\t\t\t \t<span class="glyphicon glyphicon-remove"></span>\n\t\t\t\t\t\t\t\t\t\t\t </button>\n\t\t\t\t\t\t\t\t\t\t</td>\n\t\t\t\t\t\t\t\t\t</tr>\n\t\t\t\t\t\t\t\t</tbody>\n\t\t\t\t\t\t\t</table>\n\n\t\t\t\t\t\t\t<directive-threejs data="morphologicalData.surface" height="400">\n\t\t\t\t\t\t\t</directive-threejs>\n\t\t\t  \t\t\t</div>\n\t\t\t  \t\t</div>\n\t\t\t\t</div>\n\n\t\t\t\t<div class="row" ng-if="morphologicalDataCollection.section == 1">\n\t\t\t\t\t<div class="panel panel-default">\n\t\t\t  \t\t\t<div class="panel-body">\n\t\t\t  \t\t\t\t<div class="panel panel-success">\n\t\t\t\t\t\t\t  <div class="panel-body">\n\t\t\t\t\t\t\t  \t<div class="btn-group">\n\t\t\t\t\t\t\t\t\t <button type="button" class="btn btn-default" ng-click="morphologicalDataCollection.addMorphologicalData()">\n\t\t\t\t\t\t\t\t\t \t<span class="glyphicon glyphicon-plus"></span>Upload\n\t\t\t\t\t\t\t\t\t </button>\n\t\t\t\t\t\t\t\t\t <button type="button" class="btn btn-default" ng-click="morphologicalDataCollection.section = -1">\n\t\t\t\t\t\t\t\t\t \t<span class="glyphicon glyphicon-remove"></span>Cancel\n\t\t\t\t\t\t\t\t\t </button>\n\t\t\t\t\t\t\t  \t</div>\n\t\t\t\t\t\t\t  \n\t\t\t\t\t\t\t  \t<div class="input-group">\n\t\t\t\t\t\t  \t\t\t<span class="input-group-addon">Id</span>\n\t\t\t\t\t\t  \t\t\t<input type="string" class="form-control" placeholder="Patient id (required)" aria-describedby="basic-addon3" ng-model="morphologicalData.data.patientId" ng-readonly="editFields">\n\t\t\t\t\t\t  \t\t</div>\n\t\t\t\t\t\t\t  \t<div class="input-group">\n\t\t\t\t\t\t  \t\t\t<span class="input-group-addon">Date</span>\n\t\t\t\t\t\t  \t\t\t<input type="date" class="form-control" placeholder="Date" aria-describedby="basic-addon3" ng-model="morphologicalData.data.date">\n\t\t\t\t\t\t  \t\t</div>\n\t\t\t\t\t\t  \t\t<div class="input-group">\n\t\t\t\t\t\t\t  \t\t<label class="btn btn-default" for="clinicalData-file-selector" ng-click="morphologicalData.selectedForm = -1;">\n\t\t\t\t\t\t\t\t\t \t<span class="glyphicon glyphicon-folder-open"></span>\n\t\t\t\t\t\t\t\t\t    <input id="clinicalData-file-selector" file-model=\'morphologicalData.data.file\' type="file"  style="display:none;">\n\t\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<div class="input-group">\n\t\t\t\t\t\t  \t\t\t<span class="input-group-addon">Filename</span>\n\t\t\t\t\t\t  \t\t\t<input type="text" class="form-control" placeholder="No file selected" aria-describedby="basic-addon3" ng-model="morphologicalData.data.file.name" readonly>\n\t\t\t\t\t\t  \t\t</div>\n\t\t\t\t\t\t\t  </div>\n\t\t\t\t\t\t\t</div>\n\t\t\t  \t\t\t</div>\n\t\t\t  \t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\n\t\t\n\t</div>\n</div>');
}]);